html
    head
        title Task Manager / Users
    body
        if (session.lightmode)
            include ../includes/csslight.pug
        else 
            include ../includes/cssdark.pug
        
        if (session == undefined || session.loggedin == undefined || !session.loggedin)
            include ../includes/loggedout.pug
        else
            p(style="font-weight: bold; margin-left: 7px")= "User: " + session.username
            include ../includes/loggedin.pug
        
        div#main
            h1 Tasks

            label(for='task-search')= "Search for Tasks: "
            input#tasksearch(type='text' name='task-search')
            button#tasksearchbutton(type='button')= "Search"
            
            if (tasks.length == 0)
                p No tasks found...
            
            for t in tasks
                if (session.username == t.username || !t.privacy)
                    if (t.priority == 'high')
                        div.taskcard(style = "background-color:#ebafa0; box-shadow: 0px 0px 4px 4px #ebafa0; width: 850px; height: 150px; margin-left: 15%;")
                            div(style = 'float: left; width: 400px; height: 150px')
                                a(href="/" + t._id style='text-decoration: none')= t.name 
                                p= "Assigned to: " + t.username
                                p= "Due: " + t.datetimeformat

                            //Lists all subtasks
                            div(style = 'float: left; width: 400px; height: 150px')
                                p Subtasks:
                                if (t.subtasks)
                                    - for (let i = 0; i < t.subtasks.length; i++){
                                        if (i == 3 )
                                            p
                                            small=" ... "
                                            - break
                                        p.small= t.subtasks[i].name + " - Due @ " + t.subtasks[i].datetimeformat
                                    - }
                                else
                                    small='None'

                    else if (t.priority == 'medium')
                        div.taskcard(style = "background-color:#ebe1a0; box-shadow: 0px 0px 4px 4px #ebe1a0; width: 850px; height: 150px; margin-left: 15%;")
                            div(style = 'float: left; width: 400px; height: 150px')
                              a(href="/" + t._id style='text-decoration: none')= t.name 
                                p= "Assigned to: " + t.username
                                p= "Due: " + t.datetimeformat

                            //Lists all subtasks
                            div(style = 'float: left; width: 400px; height: 150px')
                                p Subtasks:
                                if (t.subtasks)
                                    - for (let i = 0; i < t.subtasks.length; i++){
                                        if (i == 3 )
                                            p
                                            small=" ... "
                                            - break
                                        p.small= t.subtasks[i].name + " - Due @ " + t.subtasks[i].datetimeformat
                                    - }
                                else
                                    small='None'
                    else
                        div.taskcard(style = "background-color:#a0eba4; box-shadow: 0px 0px 4px 4px #a0eba4; width: 850px; height: 150px; margin-left: 15%;")
                            div(style = 'float: left; width: 400px; height: 150px')
                              a(href="/" + t._id style='text-decoration: none')= t.name 
                                p= "Assigned to: " + t.username
                                p= "Due: " + t.datetimeformat

                            //Lists all subtasks
                            div(style = 'float: left; width: 400px; height: 150px')
                                p Subtasks:
                                if (t.subtasks)
                                    - for (let i = 0; i < t.subtasks.length; i++){
                                        if (i == 3 )
                                            p
                                            small=" ... "
                                            - break
                                        p.small= t.subtasks[i].name + " - Due: " + t.subtasks[i].datetimeformat
                                    - }
                                else
                                    small='None'

        script.
            document.getElementById('tasksearchbutton').addEventListener("click", function(){
                let link = "http://localhost:3000/tasks/" + document.getElementById("tasksearch").value;
                window.location.assign(link);
            });
            document.getElementById()
        
 
                
    